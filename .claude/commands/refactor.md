Analyze code for refactoring opportunities.

Review the code for:
1. **Code smells**: Duplicated code, long functions, complex conditionals
2. **Design patterns**: Missing abstractions, poor separation of concerns
3. **Performance**: Inefficient algorithms, unnecessary computations
4. **Maintainability**: Unclear naming, missing documentation, tight coupling
5. **Testing**: Hard-to-test code, missing test coverage

For each issue found:
- Explain why it's a problem
- Show the current code
- Propose a refactored version
- Explain the benefits of the change

Prioritize suggestions by impact and effort.
Ask before making any changes.
